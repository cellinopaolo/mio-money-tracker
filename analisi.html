async function runAnalysis() {
            // Recuperiamo tutte le transazioni
            const { data: trans } = await supabaseClient.from('transactions').select('*');
            if (!trans) return;

            const now = new Date();
            const startOfCurrMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            const startOfPrevMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);
            
            const startOfCurrSix = new Date(now.getFullYear(), now.getMonth() - 5, 1);
            const startOfPrevSix = new Date(now.getFullYear(), now.getMonth() - 11, 1);

            const startOfCurrYear = new Date(now.getFullYear(), 0, 1);
            const startOfPrevYear = new Date(now.getFullYear() - 1, 0, 1);

            let stats = {
                currMonth: 0, prevMonth: 0,
                currSix: 0, prevSix: 0,
                currYear: 0, prevYear: 0
            };

            trans.forEach(t => {
                const d = new Date(t.data_transazione);
                // FILTRO: Consideriamo solo le USCITE (importo < 0)
                // Usiamo Math.abs per rendere il numero positivo nei grafici
                if (t.importo < 0) {
                    const val = Math.abs(parseFloat(t.importo));

                    // Confronto Mensile
                    if (d >= startOfCurrMonth) stats.currMonth += val;
                    else if (d >= startOfPrevMonth) stats.prevMonth += val;

                    // Confronto Semestrale
                    if (d >= startOfCurrSix) stats.currSix += val;
                    else if (d >= startOfPrevSix && d < startOfCurrSix) stats.prevSix += val;

                    // Confronto Annuale
                    if (d >= startOfCurrYear) stats.currYear += val;
                    else if (d >= startOfPrevYear && d < startOfCurrYear) stats.prevYear += val;
                }
            });

            updateUI(stats);
        }

        // La funzione updateUI rimane la stessa, ma ora i colori 
        // del trend saranno più intuitivi: 
        // Se spendi PIÙ del periodo precedente = ROSSO (Male)
        // Se spendi MENO del periodo precedente = VERDE (Bene)
